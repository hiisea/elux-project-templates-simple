<%
  const typeMap = {
    'reactRedux-csr': 'react',
    'reactRedux-micro': 'react',
    'reactRedux-ssr': 'react ssr',
    'vueVuex-csr': 'vue',
    'vueVuex-micro': 'vue',
    'vueVuex-ssr': 'vue ssr',
  };
  const type = typeMap[framework + '-' + platform];
-%>
const {localIP} = require('@elux/cli-utils');
const apiHost = `http://${localIP}:3003/`;
const serverPort = 4003;
<% if(platform==='ssr'){ -%>
const testUrl = `http://${localIP}:${serverPort}`;
<% } -%>
module.exports = {
  type: '<%= type %>',
  mockServer: {port: 3003},
  cssProcessors: {<%= css==='less'?'less':'sass' %>: true},
  all: {
    //开发和生成环境都使用的配置
    serverPort,
    clientGlobalVar: {
      ApiPrefix: apiHost,
      StaticPrefix: apiHost,
    },
<% if(platform==='ssr'){ -%>
    serverGlobalVar: {
      ApiPrefix: apiHost,
      StaticPrefix: apiHost,
    },
<% } -%>
  },
  dev: {
    //开发环境专用配置
    eslint: false,
    stylelint: false,
    clientGlobalVar: {
      ApiPrefix: '/api/',
    },
    apiProxy: {
      '/api': {
        target: apiHost,
        pathRewrite: {
          '^/api': '',
        },
      },
    },
  },
<% if(platform==='ssr'){ -%>
  gen: {
    override: true,
    entries: [
      (env) => [
        {url: `${testUrl}/index`, dist: `./dist/${env}/gen/index.html`},
        {url: `${testUrl}/login`, dist: `./dist/${env}/gen/login.html`},
      ],
      (env) => {
        return new Array(10)
          .fill(0)
          .map((_, index) => ({url: `${testUrl}/article/page/${index + 1}`, dist: `./dist/${env}/gen/article/page/${index + 1}.html`}));
      },
      (env) => {
        return new Array(10)
          .fill(0)
          .map((_, index) => ({url: `${testUrl}/article/detail/${index + 1}`, dist: `./dist/${env}/gen/article/detail/${index + 1}.html`}));
      },
    ],
  },
<% } -%>
};
